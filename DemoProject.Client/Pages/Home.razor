@page "/{url?}"
@using DemoProject.Client.Pages.NotePadPW
@using DemoProject.Client.Service

<RadzenDialog></RadzenDialog>
<RadzenNotification></RadzenNotification>


<div style="display: flex; justify-content: center; margin-top: 2rem;">
    <div style="width: 85%;">

        <RadzenHtmlEditor @bind-Value=@htmlValue Input="OnInput" Execute="OnExecute" style="height: 80vh;" Disabled="@IsEditorDisabled">
            <RadzenHtmlEditorUndo />
            <RadzenHtmlEditorRedo />

            <RadzenHtmlEditorSeparator />

            <RadzenHtmlEditorBold />
            <RadzenHtmlEditorItalic />
            <RadzenHtmlEditorUnderline />
            <RadzenHtmlEditorStrikeThrough />

            <RadzenHtmlEditorSeparator />

            <RadzenHtmlEditorAlignLeft />
            <RadzenHtmlEditorAlignCenter />
            <RadzenHtmlEditorAlignRight />

            <RadzenHtmlEditorSeparator />

            <RadzenHtmlEditorIndent />
            <RadzenHtmlEditorOutdent />
            <RadzenHtmlEditorUnorderedList />
            <RadzenHtmlEditorOrderedList />

            <RadzenHtmlEditorSeparator />

            <RadzenHtmlEditorColor />
            <RadzenHtmlEditorBackground />

            <RadzenHtmlEditorSeparator />

            <RadzenHtmlEditorRemoveFormat />
            <RadzenHtmlEditorSubscript />
            <RadzenHtmlEditorSuperscript />

            <RadzenHtmlEditorSeparator />

            <RadzenHtmlEditorLink />
            <RadzenHtmlEditorUnlink />
            <RadzenHtmlEditorImage />
            <RadzenHtmlEditorFontName />
            <RadzenHtmlEditorFontSize />
            <RadzenHtmlEditorFormatBlock />

            <RadzenHtmlEditorSeparator />


            <RadzenHtmlEditorCustomTool CommandName="ChangeUrl" Icon="edit" />
            <RadzenHtmlEditorCustomTool CommandName="SetPassword" Icon="password" />

            <AuthorizeView>
                <Authorized>
                    <RadzenHtmlEditorCustomTool CommandName="GeneratePdf" Icon="picture_as_pdf" />
                </Authorized>
            </AuthorizeView>

            <RadzenHtmlEditorSeparator />
            <AuthorizeView>
                <Authorized>
                    <RadzenHtmlEditorCustomTool CommandName="DeleteNote" Icon="delete" />
                </Authorized>
            </AuthorizeView>

        </RadzenHtmlEditor>
    </div>
</div>


<SetPassworddComponent Value="@password"
                       IsOpen="@IsOpenPassword"
                       OnSave="OnModalSavePassword"
                       OnProtectForMe="OnProtecMeModalSave"
                       OnClose="() => IsOpenPassword = false" />

<ChangeUrlComponent Value="@url"
                    IsOpen="@IsOpen"
                    OnSave="OnModalSave"
                    OnClose="() => IsOpen = false" />

<PutPasswordComponent Value="@passwordToOpen"
                      IsOpen="@IsOpenPutPassword"
                      OnSave="OnModalSavePutPassword"
                      OnClose="() => IsOpenPutPassword = false" />


<AuthorizeView>
    <Authorized>
        <button class="floating-button" @onclick="OpenSummarizePanel">
            🤖 AI Summarizer
        </button>

        <SummarizeComponent Text="@noteSummary" IsOpen="@showPanel"
                            IsLoading="@IsLoading"
                            OnClose="@(() => { showPanel = false; })" />
    </Authorized>

</AuthorizeView>

@if (showDeleteConfirm)
{
    <div class="confirm-backdrop" @onclick="() => showDeleteConfirm = false">
        <div class="confirm-popup" @onclick:stopPropagation>
            <div class="confirm-message">Do you want to delete this note?</div>
            <div class="confirm-actions">
                <button class="btn btn-danger" @onclick="ConfirmDelete">Yes</button>
                <button class="btn btn-secondary" @onclick="() => showDeleteConfirm = false">No</button>
            </div>
        </div>
    </div>
}






